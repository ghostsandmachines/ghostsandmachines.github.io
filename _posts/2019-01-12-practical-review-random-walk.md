---
layout: post
title: "A practical review of brownian motion"
date: 2019-01-12
---

I am going to start with the simplest random walk model, brownian motion. Brownian motion describes the motion of molecules in a solvent, moving under the influence of the collisions with the small fluid particles. It was discovered more than a hundred years, but even such old and well-known model contains several non-trivial results that aren't really well-known. Everybody has seen the weird square root scaling of the distance with time, but once you start asking about first-passage times and the effect of confinedness many students have no clue. 

In describing brownian motion, it is important to switch confidently from discrete models to continuous models, both in space and time. This is helpful both analytically and computationally and it is the focus of this review.

Let us start with a completely discrete model. At any time $t \in \mathbb{N} $, the particle is described by state $\mathbf{n} \in \mathbb{N}^d $, a position in a discrete $d$-dimensional lattice. A trajectory $N$-steps long $\{\mathbf{n_0}, \mathbf{n_1}, .., \mathbf{n_N}\}$ is generated by starting from a position $\mathbf{n_0}$, choosing randomly the next position among the $2d$ possible neighbors, moving to this neighbor and repeating the process. Physically, translation and rotational symmetry are assumed, therefore each neighbor is chosen uniformy with probability $\frac{1}{2d}$ for any starting position.  At this point, the model is completely defined and one can start simulating trajectories with a computer for example.

From discrete to continuous time
--------------------------------

How do we add real time to the model? Well, physical time here really enters only in how long we have to wait to transit from one state to the next. The object $\{\mathbf{n_0}, \mathbf{n_1}, .., \mathbf{n_N}\}$ makes sense with real time as well, we just follow the particle and annotate the first $N$-states it visits. On the other hand, specifying the whole trajectory requires specifying the holding times as well and consequently the full trajectory is now given by 

$$\{\mathbf{n_0}, \Delta t_1; \mathbf{n_1}, \Delta t_2; .., \mathbf{n_{N-1}}, \Delta t_{N}; \mathbf{n_N}\}$$

with $\Delta t_k = t_{k+1} - t_{k}$. Now, $\Delta t_k$ is a random variable as well and it indicates how long the particle remains in the state or how long it takes for the particle to jump away from the state. Translational symmetry implies that $\Delta t$ is extracted from the same probability distribution, no matter what the current state is. 

What is this probability distribution? This is slightly less obvious. In principle you might think that any probability distribution is possible and mathematically that is probably true. In practice a large class of systems is described by the same probability distribution. To see this, imagine you are looking at the particle in some position on the lattice and you are waiting for the jump. Imagine you have already waited for a time $\Delta t = s$. Does the probability distribution for waiting time change? Do you expect the particle to jump more quickly it has already stayed for a time $s$ in the same position? Surely not, if the events causing the jumps are independent from one another. This is what happens if you have imagine the collisions of the small fluid-particles with the particle we are looking at. The probabiliy of causing net motion in a direction at time $t$ does not depend on whether or not a net motion was caused at time $t-dt$, in the same way that with a fair coin the probability of having tails does not depend on whether you've had tails before. Translating mathematically this argument gives:

$$
P(\Delta t > s+u) = P(\Delta t > s) P(\Delta t > u)
$$

which is a functional equation for an exponential. Therefore:

$$
P(\Delta t ) = \frac{1}{\tau} \exp \left (-\frac{t}{\tau} \right)
$$

which means that considering the process in real time adds one parameter $\tau$. We can use this equation for translating results obtained simulating trajectories on the abstract lattice to physical results. For instance consider a trajectory $N$-steps long $\{\mathbf{n_0}, \mathbf{n_1}, .., \mathbf{n_N}\}$ generated with the procedure described before. How much real time has passed? With $N$-steps, the total time elapsed is:

$$
T_N = \sum_{k=0}^{N-1} \Delta t_k
$$

Each $\Delta t_k$ is independent from one another, so for $N$ big enough we can apply the central limit theorem to approximate $P(T|N)$. In this case, though, the distribution of the sum of independent exponential random variable is known and we can write it exactly:

$$
P(T|N) = \frac{1}{\Gamma(N) \tau^N} \tau^{N-1} \exp \left(- \frac{T}{\tau} \right)
$$ 

Therefore, if starting from position $\mathbf{n}$, we studied say, the distribution $P(N)$ of the number of steps $N$ it takes to come back to $\mathbf{n}$, ie, a recurrence time, we can obtain the corresponding distribution in real time

$$
P(T)= \sum_N P(T | N) P(N) 
$$ 

Furthermore by analyzing $P(T | N)$ we can easily obtain:

$$
\langle T(N) \rangle = N \tau
$$ 

$$
\mathrm{Var}_T (N)  = N \tau^2
$$ 

$$
\frac{\sigma_T(N) }{\langle T(N) \rangle} = \frac{1}{\sqrt{N}}
$$ 

and therefore for $N$ big enough, the map $N$-$T$ is almost deterministic and it's given by $T(N) = N \tau$.

From discrete to continuous space
---------------------------------

How does one switch from a lattice model to continuous space? The trick to understand this is to interpret the statement "The particle is at position $\mathbf{n}$" in the lattice model context as "The particle is in a small volume centered around position $\mathbf{n}$". This is perfectly equivalent mathematically, but it helps enormously to switch properly from discrete to continuous space.

Now imagine knowing the full continuous space probability density $P(\mathbf{x}, t)$. Then, the probability of being in a certain volume $V_a$ is 

$$
P(\mathbf{x} \in V_a[\mathbf{n}(\mathbf{x})])= \int_{V_a} P(\mathbf{x}, t) d\mathbf{x}
$$

where $V_a[\mathbf{n}(\mathbf{x})]$ is the volume centered around the discrete position that is closest to $\mathbf{x}$. $a$ is a linear scale determining the size of the volume, for square lattices $V_a = a^d$,  and it is in principle arbitrary. Now choose $a$ such that $P(\mathbf{x}, t)$ is practically uniform over the volume $V_a$. Then

$$
P(\mathbf{x} \in V_a[\mathbf{n}(\mathbf{x})])= P(\mathbf{x}, t) \cdot V_a
$$

or

$$
P(\mathbf{x}, t) = P(\mathbf{x} \in V_a[\mathbf{n}(\mathbf{x})]) \cdot \frac{1}{V_a}
$$

It is not difficult to see that the length scale $a$ over which $P(\mathbf{x}, t)$ is uniform should be related to the linear size of the particle in question. We often idealize particles as infinitely small points, but of course they are not and large biomolecules like proteins are much bigger than the molecules in the solvent they are random-walking about.

These equations define the connection between discrete models in space to continuous models.

Finally, we note also that $\tau$ considered in the previous section is the typical timescale necessary for the molecules to move through a distance roughly as long as its size. This is really the parameter that contains a lot of physics, from the temperature to the viscosity of the medium. It is quite simple to see how it relates to the diffusion constant, which is the usual parameter people speak about when considering brownian motion. By the well-known equation

$$
\left \langle [\mathbf{x(t)}-\mathbf{x_0}]^2 \right \rangle = D t
$$

then, we plug in the definition of $\tau$ given above

$$
a^2 = D \tau
$$

and therefore

$$
D = \frac{a^2}{\tau}
$$

Characterizing $D$ or $\tau$ in terms of other physical parameters is perfectly equivalent. Such characterization would deserve its own discussion, at any rate, the Einstein relation and its various forms do exactly that.